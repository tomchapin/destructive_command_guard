# False positives: git commands that MUST be allowed
#
# These commands are safe and should NOT trigger denials.

[[case]]
description = "git status is safe"
command = "git status"
expected = "allow"

[[case]]
description = "git status with flags"
command = "git status --short --branch"
expected = "allow"

[[case]]
description = "git log is safe"
command = "git log --oneline -10"
expected = "allow"

[[case]]
description = "git diff is safe"
command = "git diff HEAD~1"
expected = "allow"

[[case]]
description = "git branch list is safe"
command = "git branch -a"
expected = "allow"

[[case]]
description = "git branch create is safe"
command = "git branch feature-new"
expected = "allow"

[[case]]
description = "git add is safe"
command = "git add ."
expected = "allow"

[[case]]
description = "git commit is safe"
command = "git commit -m 'Add feature'"
expected = "allow"

[[case]]
description = "git push without force is safe"
command = "git push origin main"
expected = "allow"

[[case]]
description = "git pull is safe"
command = "git pull origin main"
expected = "allow"

[[case]]
description = "git fetch is safe"
command = "git fetch --all"
expected = "allow"

[[case]]
description = "git checkout without force is safe"
command = "git checkout main"
expected = "allow"

[[case]]
description = "git checkout new branch is safe"
command = "git checkout -b new-feature"
expected = "allow"

[[case]]
description = "git stash is safe"
command = "git stash"
expected = "allow"

[[case]]
description = "git stash pop is safe"
command = "git stash pop"
expected = "allow"

[[case]]
description = "git stash apply is safe"
command = "git stash apply"
expected = "allow"

[[case]]
description = "git merge is safe"
command = "git merge feature-branch"
expected = "allow"

[[case]]
description = "git rebase is safe"
command = "git rebase main"
expected = "allow"

[[case]]
description = "git reset soft is safe"
command = "git reset --soft HEAD~1"
expected = "allow"

[[case]]
description = "git reset mixed (default) is safe"
command = "git reset HEAD~1"
expected = "allow"

[[case]]
description = "git branch delete lowercase is safe"
command = "git branch -d merged-branch"
expected = "allow"

[[case]]
description = "git remote is safe"
command = "git remote -v"
expected = "allow"

[[case]]
description = "git show is safe"
command = "git show HEAD"
expected = "allow"

[[case]]
description = "git tag is safe"
command = "git tag v1.0.0"
expected = "allow"

[[case]]
description = "sudo git status is safe (wrapper prefix)"
command = "sudo git status"
expected = "allow"

[[case]]
description = "env prefix with git status is safe"
command = "env FOO=1 git status"
expected = "allow"

[[case]]
description = "command wrapper with git status is safe"
command = "command git status"
expected = "allow"

[[case]]
description = "backslash-escaped git status is safe"
command = "\\git status"
expected = "allow"

[[case]]
description = "git commit message containing rm -rf is safe"
command = "git commit -m \"Fix rm -rf detection\""
expected = "allow"
